{% extends "layout.html" %}
{% block content %}
{% if creator %}
    <h1 class="text-3xl font-bold mb-6 text-gray-100">Quizzes by {{ creator.display_name }}</h1>
{% elif specific_quiz %}
    <h1 class="text-3xl font-bold mb-6 text-gray-100">Details for Quiz: <span class="text-cyan-400">{{ specific_quiz.title }}</span></h1>
{% else %}
    <h1 class="text-3xl font-bold mb-6 text-gray-100">All Quizzes</h1>
{% endif %}

<div class="bg-gray-800 rounded-lg shadow-md overflow-hidden">
    <table class="w-full text-left">
        <thead class="bg-gray-700">
            <tr>
                <th class="table-cell">Title</th>
                <th class="table-cell">Quiz ID</th>
                <th class="table-cell">Creator</th>
                <th class="table-cell text-center">Timer (s)</th>
                <th class="table-cell text-center">Negative Mark</th>
                <th class="table-cell">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for quiz in quizzes %}
            <tr class="border-b border-gray-700 hover:bg-gray-700/50">
                <td class="table-cell font-semibold">{{ quiz.title }}</td>
                <td class="table-cell font-mono">{{ quiz.id }}</td>
                <td class="table-cell">{{ quiz.display_name or quiz.username }}</td>
                <td class="table-cell text-center">{{ quiz.time_per_question_sec }}s</td>
                <td class="table-cell text-center">{{ quiz.negative_mark }}</td>
                <td class="table-cell space-x-2">
                    <a href="{{ url_for('quiz_details', quiz_id=quiz.id) }}" class="bg-green-600 hover:bg-green-700 text-white text-sm font-bold py-1 px-3 rounded">Details</a>
                    <form action="{{ url_for('delete_quiz', quiz_id=quiz.id) }}" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to delete this quiz and all its data? This cannot be undone.');">
                        <button type="submit" class="bg-red-600 hover:bg-red-700 text-white text-sm font-bold py-1 px-3 rounded">Delete</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="table-cell text-center text-gray-400">No quizzes found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if questions %}
<div class="mt-8">
    <h2 class="text-2xl font-bold mb-4 text-gray-100">Questions ({{ questions|length }})</h2>
    <div class="space-y-4">
    {% for q in questions %}
        <div class="bg-gray-800 p-4 rounded-lg">
            <p class="font-bold text-lg mb-2 text-gray-200">Q{{ loop.index }}: {{ q.text }}</p>
            <ul class="list-disc list-inside ml-4 space-y-1">
                {% for option in q.options %}
                    <li class="{{ 'text-green-400 font-bold' if loop.index0 == q.correctIndex else 'text-gray-300' }}">
                        {{ option }} {% if loop.index0 == q.correctIndex %} (Correct){% endif %}
                    </li>
                {% endfor %}
            </ul>
            {% if q.explanation %}
            <div class="mt-3 pt-3 border-t border-gray-700">
                <p class="text-sm text-yellow-300"><span class="font-semibold">Explanation:</span> {{ q.explanation }}</p>
            </div>
            {% endif %}
        </div>
    {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}
